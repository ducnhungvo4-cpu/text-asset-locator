# 文本资产快速定位与高亮工具实现计划

## 项目结构
```
text-asset-locator/
├── app.py              # 主应用文件
├── requirements.txt    # 依赖列表
└── utils/
    ├── file_reader.py  # 文件读取工具
    ├── search_engine.py # 搜索引擎
    └── ui_components.py # UI组件
```

## 依赖安装
```bash
pip install streamlit pandas openpyxl python-docx fuzzywuzzy
```

## 核心功能实现

### 1. 文件读取模块
- 支持 .txt 文件读取
- 支持 .docx 文件读取（使用 python-docx）
- 支持 .xlsx/.csv 文件读取（使用 pandas）

### 2. 搜索引擎模块
- 精确匹配实现
- 大小写敏感开关
- 模糊匹配（相似度 > 80%，使用 fuzzywuzzy）
- 记录关键词出现位置和次数

### 3. UI组件模块
- 双栏布局设计
- 文件上传组件
- 关键词列选择器
- 高亮文本渲染
- 资产列表显示
- 上一个/下一个导航按钮

## 功能细化

### 输入处理
1. 两个上传组件分别处理文稿和资产列表
2. 资产列表上传后，动态显示列选择器
3. 支持选择多个关键词列

### 搜索逻辑
1. 读取关键词列表
2. 遍历文稿进行匹配
3. 记录每个匹配的位置、关键词、类型
4. 支持精确/模糊匹配切换
5. 支持大小写敏感切换

### 输出展示
1. 左侧原文展示，匹配关键词高亮
2. 右侧资产列表，显示关键词、出现次数、类别
3. 点击资产列表项，左侧滚动到对应位置
4. 支持上一个/下一个匹配项导航
5. 不同类别使用不同高亮颜色

### 性能优化
1. 长文本分段加载
2. 高效匹配算法
3. 虚拟滚动支持（可选）

## 代码实现步骤

1. 创建项目结构和依赖文件
2. 实现文件读取模块
3. 实现搜索引擎模块
4. 实现UI组件和主应用
5. 测试各项功能
6. 优化性能和用户体验

## 预期效果
- 支持多种文件格式上传
- 高效的关键词匹配
- 直观的高亮显示
- 便捷的导航功能
- 良好的用户体验
- 支持长文本处理